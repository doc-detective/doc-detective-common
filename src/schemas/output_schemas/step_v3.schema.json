{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "step",
  "description": "A step in a test.",
  "type": "object",
  "dynamicDefaults": {
    "stepId": "uuid"
  },
  "properties": {
    "stepId": {
      "type": "string",
      "description": "ID of the step."
    },
    "description": {
      "type": "string",
      "description": "Description of the step."
    }
  },
  "anyOf": [
    {
      "properties": {
        "checkLink": {
          "$schema": "http://json-schema.org/draft-07/schema#",
          "title": "checkLink",
          "anyOf": [
            {
              "description": "Check if an HTTP or HTTPS URL returns an acceptable status code from a GET request.",
              "type": "string",
              "pattern": "(^(http://|https://|/).*|\\$[A-Za-z0-9_]+)",
              "transform": [
                "trim"
              ]
            },
            {
              "description": "Check if an HTTP or HTTPS URL returns an acceptable status code from a GET request.",
              "type": "object",
              "additionalProperties": false,
              "required": [
                "url"
              ],
              "properties": {
                "url": {
                  "type": "string",
                  "description": "URL to check. Can be a full URL or a path. If a path is provided, `origin` must be specified.",
                  "pattern": "(^(http://|https://|/).*|\\$[A-Za-z0-9_]+)",
                  "transform": [
                    "trim"
                  ]
                },
                "origin": {
                  "type": "string",
                  "description": "Protocol and domain to navigate to. Prepended to `url`.",
                  "transform": [
                    "trim"
                  ]
                },
                "statusCodes": {
                  "description": "Accepted status codes. If the specified URL returns a code other than what is specified here, the action fails.",
                  "type": "array",
                  "items": {
                    "oneOf": [
                      {
                        "type": "integer"
                      }
                    ]
                  },
                  "default": [
                    200,
                    201,
                    202
                  ]
                }
              }
            }
          ],
          "components": {
            "schemas": {
              "string": {
                "description": "Check if an HTTP or HTTPS URL returns an acceptable status code from a GET request.",
                "type": "string",
                "pattern": "(^(http://|https://|/).*|\\$[A-Za-z0-9_]+)",
                "transform": [
                  "trim"
                ]
              },
              "object": {
                "description": "Check if an HTTP or HTTPS URL returns an acceptable status code from a GET request.",
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "url"
                ],
                "properties": {
                  "url": {
                    "type": "string",
                    "description": "URL to check. Can be a full URL or a path. If a path is provided, `origin` must be specified.",
                    "pattern": "(^(http://|https://|/).*|\\$[A-Za-z0-9_]+)",
                    "transform": [
                      "trim"
                    ]
                  },
                  "origin": {
                    "type": "string",
                    "description": "Protocol and domain to navigate to. Prepended to `url`.",
                    "transform": [
                      "trim"
                    ]
                  },
                  "statusCodes": {
                    "description": "Accepted status codes. If the specified URL returns a code other than what is specified here, the action fails.",
                    "type": "array",
                    "items": {
                      "oneOf": [
                        {
                          "type": "integer"
                        }
                      ]
                    },
                    "default": [
                      200,
                      201,
                      202
                    ]
                  }
                }
              }
            }
          },
          "examples": [
            "https://www.google.com",
            "/search",
            {
              "url": "https://www.google.com",
              "statusCodes": [
                200
              ]
            },
            {
              "url": "/search",
              "origin": "www.google.com",
              "statusCodes": [
                200
              ]
            }
          ]
        }
      },
      "required": [
        "checkLink"
      ]
    },
    {
      "properties": {
        "goTo": {
          "$schema": "http://json-schema.org/draft-07/schema#",
          "title": "checkLink",
          "anyOf": [
            {
              "description": "Navigate to an HTTP or HTTPS URL. Can be a full URL or a path. If a path is provided, navigates relative to the current URL, if any.",
              "type": "string",
              "pattern": "(^(http://|https://|/).*|\\$[A-Za-z0-9_]+)",
              "transform": [
                "trim"
              ]
            },
            {
              "description": "Navigate to an HTTP or HTTPS URL.",
              "type": "object",
              "additionalProperties": false,
              "required": [
                "url"
              ],
              "properties": {
                "url": {
                  "type": "string",
                  "description": "URL to navigate to. Can be a full URL or a path. If a path is provided and `origin` is specified, prepends `origin` to `url`. If a path is provided but `origin` isn't specified, attempts to navigate relative to the current URL, if any.",
                  "pattern": "(^(http://|https://|/).*|\\$[A-Za-z0-9_]+)",
                  "transform": [
                    "trim"
                  ]
                },
                "origin": {
                  "type": "string",
                  "description": "Protocol and domain to navigate to. Prepended to `url`.",
                  "transform": [
                    "trim"
                  ]
                }
              }
            }
          ],
          "components": {
            "schemas": {
              "string": {
                "description": "Navigate to an HTTP or HTTPS URL. Can be a full URL or a path. If a path is provided, navigates relative to the current URL, if any.",
                "type": "string",
                "pattern": "(^(http://|https://|/).*|\\$[A-Za-z0-9_]+)",
                "transform": [
                  "trim"
                ]
              },
              "object": {
                "description": "Navigate to an HTTP or HTTPS URL.",
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "url"
                ],
                "properties": {
                  "url": {
                    "type": "string",
                    "description": "URL to navigate to. Can be a full URL or a path. If a path is provided and `origin` is specified, prepends `origin` to `url`. If a path is provided but `origin` isn't specified, attempts to navigate relative to the current URL, if any.",
                    "pattern": "(^(http://|https://|/).*|\\$[A-Za-z0-9_]+)",
                    "transform": [
                      "trim"
                    ]
                  },
                  "origin": {
                    "type": "string",
                    "description": "Protocol and domain to navigate to. Prepended to `url`.",
                    "transform": [
                      "trim"
                    ]
                  }
                }
              }
            }
          },
          "examples": [
            "https://www.google.com",
            "/search",
            {
              "url": "https://www.google.com"
            },
            {
              "url": "/search",
              "origin": "www.google.com"
            }
          ]
        }
      },
      "required": [
        "goTo"
      ]
    }
  ],
  "examples": [
    {
      "checkLink": "https://www.google.com"
    },
    {
      "stepId": "path-only",
      "checkLink": "/search"
    },
    {
      "stepId": "status-code",
      "checkLink": {
        "url": "https://www.google.com",
        "statusCodes": [
          200
        ]
      }
    },
    {
      "goTo": {
        "url": "https://www.google.com"
      }
    },
    {
      "goTo": "https://www.google.com"
    }
  ]
}